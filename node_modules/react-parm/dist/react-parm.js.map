{"version":3,"file":"react-parm.js","sources":["../src/utils.js","../src/index.js"],"sourcesContent":["// external dependencies\nimport React from 'react';\nimport {findDOMNode} from 'react-dom';\n\n/**\n * @constant {Object} IGNORED_COMPONENT_KEYS keys to ignore when creating a component\n */\nexport const IGNORED_COMPONENT_KEYS = {\n  getInitialState: true,\n  getInitialValues: true,\n  isPure: true,\n  onConstruct: true,\n  state: true\n};\n\n/**\n * @constant {Object} IGNORED_STATIC_KEYS keys to ignore when assigning statics to a component\n */\nexport const IGNORED_STATIC_KEYS = {\n  displayName: true\n};\n\n/**\n * @function addPropTypeIsRequired\n *\n * @description\n * add the isRequired method to the propType\n *\n * @param {function} propType the propType checker\n * @returns {function} the propType with the isRequired function added\n */\nexport const addPropTypeIsRequired = (propType) =>\n  (propType.isRequired = (props, key, component) =>\n    props[key] == null // eslint-disable-line eqeqeq\n      ? new Error(`The prop \\`${key}\\` is marked as required in \\`${component}\\`, but its value is \\`${props[key]}\\`.`)\n      : propType(props, key, component)) && propType;\n\n/**\n * @function bindSetState\n *\n * @description\n * bind the setState method to the component instance to ensure it can be used in a functional way\n *\n * @param {ReactComponent} instance the instance to bind setState to\n * @returns {void}\n */\nexport const bindSetState = (instance) =>\n  Object.prototype.hasOwnProperty.call(instance.setState, 'prototype')\n    ? (instance.setState = instance.setState.bind(instance))\n    : instance.setState;\n\n/**\n * @function isClassComponent\n *\n * @description\n * is the value passed a valid react component class instance\n *\n * @param {any} value the value to test\n * @returns {boolean} is the value a react component instance\n */\nexport const isClassComponent = (value) => !!value && value instanceof React.Component;\n\n/**\n * @function logInvalidInstanceError\n *\n * @description\n * notify the user that the instance passed is invalid\n *\n * @param {string} type the type of creator being called\n * @returns {void}\n */\nexport const logInvalidInstanceError = (type) =>\n  console.error(`The instance provided for use with the ${type} is not a valid React component instance.`); // eslint-disable-line no-console\n\n/**\n * @function createRefCreator\n *\n * @description\n * create a method that will assign a ref value to the instance passed\n *\n * @param {function} getter the function that gets the component value for the ref\n * @returns {function(ReactComponent, string): function((HTMLElement|Component)): void} the ref create\n */\nexport const createRefCreator = (getter) => (instance, ref) =>\n  isClassComponent(instance) ? (component) => (instance[ref] = getter(component)) : logInvalidInstanceError('ref');\n\n/**\n * @function getNamespacedRef\n *\n * @description\n * get the ref that is a combination of the raw component and the component's underlying HTML element\n *\n * @param {ReactComponent} component the component to assin\n * @returns {{component: ReactComponent, element: HTMLElement}} the namespaced ref\n */\nexport const getNamespacedRef = (component) => ({component, element: findDOMNode(component)});\n\n/**\n * @function identity\n *\n * @description\n * return the first parameter passed\n *\n * @param {any} value the value to pass through\n * @returns {any} the first parameter passed\n */\nexport const identity = (value) => value;\n","// external dependencies\nimport React from 'react';\nimport {findDOMNode} from 'react-dom';\n\n// utils\nimport {\n  IGNORED_COMPONENT_KEYS,\n  IGNORED_STATIC_KEYS,\n  addPropTypeIsRequired,\n  bindSetState,\n  createRefCreator,\n  getNamespacedRef,\n  identity,\n  isClassComponent,\n  logInvalidInstanceError\n} from './utils';\n\n/**\n * @function createCombinedRef\n *\n * @description\n * create a ref that assigns both the raw component and the underlying HTML element to the instance on a namespace\n *\n * @param {ReactComponent} instance the instance to assign to\n * @param {string} ref the instance value name\n * @returns {{component: ReactComponent, element: HTMLElement}} the combined ref\n */\nexport const createCombinedRef = createRefCreator(getNamespacedRef);\n\n/**\n * @function createComponentRef\n *\n * @description\n * create a ref that assigns the component itself to the instance\n *\n * @param {ReactComponent} instance the instance to assign to\n * @param {string} ref the instance value name\n * @returns {ReactComponent} the component ref\n */\nexport const createComponentRef = createRefCreator(identity);\n\n/**\n * @function createElementRef\n *\n * @description\n * create a ref that assigns the component's underlying HTML element to the instance\n *\n * @param {ReactComponent} instance the instance to assign to\n * @param {string} ref the instance value name\n * @returns {HTMLElement} the element ref\n */\nexport const createElementRef = createRefCreator(findDOMNode);\n\n/**\n * @function createMethod\n *\n * @description\n * create a method that is a pure version of the lifecycle / instance method passed to it\n *\n * @param {ReactComponent} instance the instance the method is assigned to\n * @param {function} method the instance method\n * @param {Array<any>} extraArgs additional args to pass to the method\n * @returns {function(...Array<any>): any} the method with the instance passed as value\n */\nexport const createMethod = (instance, method, ...extraArgs) =>\n  isClassComponent(instance)\n    ? bindSetState(instance) && ((...args) => method.call(instance, instance, args, extraArgs))\n    : logInvalidInstanceError('method');\n\n/**\n * @function createRender\n *\n * @description\n * create a method that is a pure version of the render method\n *\n * @param {ReactComponent} instance the instance the method is assigned to\n * @param {function} render the render method\n * @returns {function(): ReactElement} the method with the props and instance passed as values\n */\nexport const createRender = (instance, render) =>\n  isClassComponent(instance)\n    ? bindSetState(instance) && ((...args) => render.call(instance, instance.props, instance, args))\n    : logInvalidInstanceError('render');\n\n/**\n * @function createRenderProps\n *\n * @description\n * create a render props method, where the props passed and the instance it is rendered in are passed as props to it\n *\n * @param {ReactComponent} instance the instance the method is assigned to\n * @param {function} renderProps the render props method\n * @returns {function(Object): ReactElement} the method with the props and instance passed as values\n */\nexport const createRenderProps = (instance, renderProps) =>\n  isClassComponent(instance)\n    ? bindSetState(instance) && ((props, ...restOfArgs) => renderProps.call(instance, props, instance, restOfArgs))\n    : logInvalidInstanceError('render props');\n\n/**\n * @function createValue\n *\n * @description\n * create a value to assign to the instance based on props or the instance itself\n *\n * @param {ReactComponent} instance the instance the method is assigned to\n * @param {function} getValue the function to get the value with\n * @param {Array<any>} extraArgs additional args to pass to the method\n * @returns {function(...Array<any>): any} the method with the instance passed as value\n */\nexport const createValue = (instance, getValue, ...extraArgs) =>\n  isClassComponent(instance)\n    ? bindSetState(instance) && getValue.call(instance, instance, extraArgs)\n    : logInvalidInstanceError('value');\n\n/**\n * @function createComponent\n *\n * @description\n * create a component from the render method and any options passed\n *\n * @param {function} render the function to render the component\n * @param {Object} [options={}] the options to render the component with\n * @param {function} [getInitialState] the method to get the initial state with\n * @param {boolean} [isPure] is PureComponent used\n * @param {function} [onConstruct] a method to call when constructing the component\n * @param {Object} [state] the initial state\n * @returns {ReactComponent} the component class\n */\nexport const createComponent = (render, options) => {\n  const {getInitialState, getInitialValues, isPure, onConstruct, state} = options || {};\n  const Constructor = isPure ? React.PureComponent : React.Component;\n\n  function ParmComponent(initialProps) {\n    Constructor.call(this, initialProps);\n\n    this.state = typeof getInitialState === 'function' ? createValue(this, getInitialState) : state || null;\n\n    for (let key in options) {\n      if (!IGNORED_COMPONENT_KEYS[key]) {\n        this[key] =\n          typeof options[key] === 'function'\n            ? options[key].isRender\n              ? createRender(this, options[key])\n              : options[key].isRenderProps ? createRenderProps(this, options[key]) : createMethod(this, options[key])\n            : options[key];\n      }\n    }\n\n    const values = typeof getInitialValues === 'function' ? createValue(this, getInitialValues) : null;\n\n    if (values && typeof values === 'object') {\n      for (let key in values) {\n        this[key] = values[key];\n      }\n    }\n\n    this.render = createRender(this, render);\n\n    if (typeof onConstruct === 'function') {\n      onConstruct(this);\n    }\n\n    return this;\n  }\n\n  ParmComponent.prototype = Object.create(Constructor.prototype);\n\n  ParmComponent.displayName = render.displayName || render.name || 'ParmComponent';\n\n  Object.keys(render).forEach(\n    (staticKey) => !IGNORED_STATIC_KEYS[staticKey] && (ParmComponent[staticKey] = render[staticKey])\n  );\n\n  return ParmComponent;\n};\n\n/**\n * @function createPropType\n *\n * @description\n * create a custom prop type handler\n *\n * @param {function(Object): (Error|null)} handler the prop type handler\n * @returns {function} the custom prop type\n */\nexport const createPropType = (handler) =>\n  addPropTypeIsRequired((props, key, component, locationIgnored, fullKey) =>\n    handler({\n      component,\n      key,\n      name: fullKey ? fullKey.split(/(\\.|\\[)/)[0] : key,\n      path: fullKey || key,\n      props,\n      value: props[key]\n    })\n  );\n"],"names":["IGNORED_COMPONENT_KEYS","getInitialState","getInitialValues","isPure","onConstruct","state","IGNORED_STATIC_KEYS","displayName","addPropTypeIsRequired","propType","isRequired","props","key","component","Error","bindSetState","instance","Object","prototype","hasOwnProperty","call","setState","bind","isClassComponent","value","React","Component","logInvalidInstanceError","type","console","error","createRefCreator","getter","ref","getNamespacedRef","element","findDOMNode","identity","createCombinedRef","createComponentRef","createElementRef","createMethod","method","extraArgs","args","createRender","render","createRenderProps","renderProps","restOfArgs","createValue","getValue","createComponent","options","Constructor","PureComponent","ParmComponent","initialProps","isRender","isRenderProps","values","create","name","keys","forEach","staticKey","createPropType","handler","locationIgnored","fullKey","split","path"],"mappings":"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"}